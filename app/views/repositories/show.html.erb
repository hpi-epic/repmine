<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    var data = google.visualization.arrayToDataTable(<%= raw @stats.to_json %>);

    var options = {
      pieSliceText: 'value'
    };

    var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
    chart.draw(data, options);
  }
</script>

<% unless @job.nil? %>
  <% content_for :javascript_includes do %>
    <%= javascript_include_tag "repository_overview.js" %>
  <% end %>
  <script type="text/javascript">
    var job_id = <%= @job.id %>;
  </script>

  <div class="well">
    <div class="row">
      <div class="col-xs-12">
        <div class="progress-status text-primary"></div>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12">
        <div class="progress progress-striped active">
          <div class="bar">
            <div class="text-primary">0%</div>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>

<table style="width:40%">
  <tr>
    <td><h4><%= @repository.name %></h4></td></tr>
  <tr>
    <td style="vertical-align:top;">
      <%= link_to "Create Query Pattern", new_pattern_path(), {:class => "btn btn-primary"} %>
      <%= link_to "Extract Data Schema", repository_extract_schema_path(@repository), {:class => "btn btn-success"} %>
      <hr />
    <td>
  </tr>
  <tr>
    <td>
      <%= label_tag("Statistics")%>
      <div id="chart_div" style="width: 700px; height: 400px;"></div>
    </td>
  </tr>
</table>
